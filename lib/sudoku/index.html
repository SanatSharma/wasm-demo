<!DOCTYPE html>
<html>
<head>
    <style>
canvas {
    border: 1px solid #d3d3d3;
    background-color: #f1f1f1;
}
</style>
</head>
<body>

<table>
    <tr><td>JS:</td><td><span id='js-time'>0</span></td></td>
    <tr><td>WASM:</td><td><span id='wasm-time'>0</span></td></td>
</table>

  <script>
    'use strict';
    function mainWorker() {
        startGame();   
        const total = [ 0, 0 ];
        const solved = [ 0, 0 ];

        const out = [
            document.getElementById('wasm-time'),
            document.getElementById('js-time')
        ];

        function update(index, time) {
            if(index == 0) {
                updateWasmGameArea(event.data.model);
            }
            else if (index == 1) {
                updateJSGameArea(event.data.model);
            }
           // console.log("hey");
           // console.log(event.data)
            total[index] += event.data.time;
            solved[index]++;
            out[index].textContent = event.data.time;
        }

        // const wasmWorker = new Worker('wasm-worker.js');
        // wasmWorker.addEventListener('message', event => {
        //     const t = event.data;
        //     console.log(`WASM: ${t}`);
        //     update(0, t);
        // });

        const jsWorker = new Worker('js-worker.js');
        jsWorker.addEventListener('message', event => {
            const t = event.data;
            console.log(`JS: ${t}`);
            update(1, t);   
        });
    }
    
  </script>

<button type=button style="margin-top:50px; margin-left:44%; font-size:30px" onclick="mainWorker()">Solve Sudoku</button>

<script>

var table = new Array(9);
var tableW = new Array(9);

function startGame() {
    var i = 0;
    var j = 0;
    for (i = 0; i < 9; i++) {
        table[i] = new Array(9);
        for (j = 0; j < 9; j++) {
            table[i][j] = new component("50px", "50px", "black", (j + 1)*50, (i+1)*50);
        }
    }
    for (i = 0; i < 9; i++) {
        tableW[i] = new Array(9);
        for (j = 0; j < 9; j++) {
            tableW[i][j] = new component("50px", "50px", "black", (j + 11)*50, (i+1)*50);
        }
    }
    myGameArea.start();
}

var myGameArea = {
    canvas : document.createElement("canvas"),
    start : function() {
        this.canvas.width = 1000;
        this.canvas.height = 1000;
        this.context = this.canvas.getContext("2d");
        document.body.insertBefore(this.canvas, document.body.childNodes[0]);
        
        //this.interval = setInterval(updateGameArea, 100);
    },
    clear : function() {
        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
    }
}

function component(width, height, color, x, y) {
    this.text = 0;
    this.width = width;
    this.height = height;  
    this.x = x;
    this.y = y;    
    this.update = function() {
        ctx = myGameArea.context;

            ctx.font = this.width + " " + this.height;
            ctx.fillStyle = color;
            ctx.fillText(this.text, this.x, this.y);
        
    }
    this.clear = function() {
        ctx = myGameArea.context;
        ctx.clearRect(this.x, this.y, this.width, this.height);
    }
}
var count = 0;
function updateJSGameArea(newNumber) {
    var i = 0;
    var j = 0;
    //myGameArea.clear();
    //console.log(newNumber);
    for(i = 0; i < 9; i++) {
        for(j = 0; j < 9; j++) {
                //console.log(newNumber);
                table[i][j].text = newNumber[i][j];
                table[i][j].update();
        }
    }
}

function updateWasmGameArea(newNumber) {
    var i = 0;
    var j = 0;
    myGameArea.clear();
    //console.log(newNumber);
    for(i = 0; i < 9; i++) {
        for(j = 0; j < 9; j++) {
                //console.log(newNumber);
                tableW[i][j].text = newNumber[i][j];
                tableW[i][j].update();
        }
    }
}
    

</script>
</body>
</html>
